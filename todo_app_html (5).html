<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Task Manager Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { 
            font-family: 'Inter', sans-serif; 
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 400% 400%;
            animation: gradientShift 12s ease infinite;
            min-height: 100vh;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .priority-high { 
            border-left: 4px solid #ef4444;
            background: linear-gradient(90deg, rgba(239, 68, 68, 0.1) 0%, transparent 100%);
        }
        .priority-medium { 
            border-left: 4px solid #f59e0b;
            background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 0%, transparent 100%);
        }
        .priority-low { 
            border-left: 4px solid #10b981;
            background: linear-gradient(90deg, rgba(16, 185, 129, 0.1) 0%, transparent 100%);
        }
        
        .category-badge {
            color: white;
            font-weight: 600;
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            text-transform: capitalize;
        }
        
        .category-work { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .category-health { background: linear-gradient(135deg, #10b981, #047857); }
        .category-personal { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .category-learning { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .category-finance { background: linear-gradient(135deg, #eab308, #ca8a04); }
        .category-productivity { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .category-general { background: linear-gradient(135deg, #6b7280, #4b5563); }
        
        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            color: white;
        }
        
        .filter-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .filter-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            transition: width 0.5s ease;
            border-radius: 9999px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }
        
        .ai-badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .todo-item {
            transition: all 0.3s ease;
            border-radius: 0;
        }
        
        .todo-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(4px);
        }
        
        .completed {
            opacity: 0.6;
            background: rgba(255, 255, 255, 0.05) !important;
        }
        
        .input-field {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .overdue-badge {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .due-today-badge {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .suggestion-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .suggestion-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .glass {
                margin: 0.5rem;
            }
            
            .notification {
                right: 10px;
                top: 10px;
                max-width: calc(100vw - 20px);
            }
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div id="notification" class="notification glass rounded-xl p-4 text-white">
        <div class="flex items-center gap-3">
            <div class="w-6 h-6 rounded-full bg-green-500 flex items-center justify-center flex-shrink-0">
                <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
            </div>
            <span id="notificationText" class="text-sm font-medium">Task completed!</span>
        </div>
    </div>

    <div class="min-h-screen p-4 md:p-6">
        <div class="max-w-6xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8 md:mb-10">
                <div class="flex items-center justify-center gap-4 mb-6">
                    <div class="p-3 glass rounded-2xl">
                        <svg class="w-8 h-8 md:w-10 md:h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h1 class="text-3xl md:text-5xl font-bold text-white">AI Task Manager</h1>
                </div>
                <p class="text-white/80 text-base md:text-lg">Smart productivity with AI insights</p>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-3 gap-6 md:gap-8">
                <div class="xl:col-span-2 space-y-6 md:space-y-8">
                    <!-- Add Todo -->
                    <div class="glass rounded-2xl p-4 md:p-6 hover-lift">
                        <div class="space-y-4">
                            <div class="flex gap-3 md:gap-4">
                                <input
                                    type="text"
                                    id="newTodo"
                                    placeholder="Add a new task... AI will categorize it automatically"
                                    class="flex-1 px-4 py-3 input-field rounded-xl text-gray-800 placeholder-gray-500"
                                />
                                <button
                                    onclick="toggleAdvancedOptions()"
                                    id="advancedToggle"
                                    class="px-3 md:px-4 py-3 glass text-white rounded-xl font-semibold hover:bg-white/20 transition-all"
                                    title="Advanced Options"
                                >
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"/>
                                    </svg>
                                </button>
                                <button
                                    onclick="addTodo()"
                                    class="px-4 md:px-6 py-3 btn-primary text-white rounded-xl font-semibold"
                                >
                                    <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                    </svg>
                                    Add
                                </button>
                            </div>
                            
                            <!-- Advanced Options -->
                            <div id="advancedOptions" class="hidden pt-4 border-t border-white/20">
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <div>
                                        <label class="block text-white/80 text-sm font-medium mb-2">Due Date</label>
                                        <input
                                            type="date"
                                            id="dueDate"
                                            class="w-full px-3 py-2 input-field rounded-lg text-gray-800"
                                        />
                                    </div>
                                    <div>
                                        <label class="block text-white/80 text-sm font-medium mb-2">Due Time</label>
                                        <input
                                            type="time"
                                            id="dueTime"
                                            class="w-full px-3 py-2 input-field rounded-lg text-gray-800"
                                        />
                                    </div>
                                    <div>
                                        <label class="block text-white/80 text-sm font-medium mb-2">Category</label>
                                        <select
                                            id="manualCategory"
                                            class="w-full px-3 py-2 input-field rounded-lg text-gray-800"
                                        >
                                            <option value="auto">Auto-detect</option>
                                            <option value="work">Work</option>
                                            <option value="health">Health</option>
                                            <option value="personal">Personal</option>
                                            <option value="learning">Learning</option>
                                            <option value="finance">Finance</option>
                                            <option value="productivity">Productivity</option>
                                            <option value="general">General</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-white/80 text-sm font-medium mb-2">Priority</label>
                                        <select
                                            id="manualPriority"
                                            class="w-full px-3 py-2 input-field rounded-lg text-gray-800"
                                        >
                                            <option value="auto">Auto-detect</option>
                                            <option value="high">High</option>
                                            <option value="medium">Medium</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-white/80 text-sm font-medium mb-2">Notes (Optional)</label>
                                        <textarea
                                            id="taskNotes"
                                            placeholder="Add any additional notes or details..."
                                            class="w-full px-3 py-2 input-field rounded-lg text-gray-800 resize-none"
                                            rows="2"
                                        ></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-white/80 text-sm font-medium mb-2">Time (min)</label>
                                        <input
                                            type="number"
                                            id="manualTime"
                                            placeholder="Auto"
                                            min="5"
                                            max="480"
                                            class="w-full px-3 py-2 input-field rounded-lg text-gray-800"
                                        />
                                    </div>
                                    <div class="flex items-end">
                                        <label class="flex items-center space-x-2 text-white/80">
                                            <input
                                                type="checkbox"
                                                id="markImportant"
                                                class="w-4 h-4 text-blue-600 bg-white border-gray-300 rounded focus:ring-blue-500"
                                            />
                                            <span class="text-sm font-medium">Important</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Suggestions -->
                    <div id="aiSuggestions" class="glass rounded-2xl p-4 md:p-6 text-white hover-lift hidden">
                        <div class="flex items-center gap-3 mb-6">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/>
                            </svg>
                            <h3 class="text-xl font-semibold">AI Suggestions</h3>
                        </div>
                        <div id="suggestionsList" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </div>

                    <!-- Stats -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="glass rounded-xl p-4 hover-lift text-center">
                            <p class="text-2xl font-bold text-white" id="totalCount">0</p>
                            <p class="text-white/70 text-sm">Total</p>
                        </div>
                        <div class="glass rounded-xl p-4 hover-lift text-center">
                            <p class="text-2xl font-bold text-white" id="activeCount">0</p>
                            <p class="text-white/70 text-sm">Active</p>
                        </div>
                        <div class="glass rounded-xl p-4 hover-lift text-center">
                            <p class="text-2xl font-bold text-white" id="completedCount">0</p>
                            <p class="text-white/70 text-sm">Done</p>
                        </div>
                        <div class="glass rounded-xl p-4 hover-lift text-center">
                            <p class="text-2xl font-bold text-white" id="productivityLevel">Good</p>
                            <p class="text-white/70 text-sm">Level</p>
                        </div>
                    </div>

                    <!-- Search and Filters -->
                    <div class="glass rounded-2xl p-4 md:p-6 hover-lift">
                        <div class="flex flex-col lg:flex-row gap-4">
                            <div class="flex-1 relative">
                                <svg class="absolute left-3 top-3 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                                <input
                                    type="text"
                                    id="searchInput"
                                    placeholder="Search tasks..."
                                    class="w-full pl-10 pr-4 py-3 input-field rounded-xl text-gray-800"
                                    oninput="filterTodos()"
                                />
                            </div>
                            
                            <div class="flex gap-2 flex-wrap">
                                <button onclick="setFilter('all')" class="filter-btn active px-4 py-2 rounded-lg font-medium text-sm">All</button>
                                <button onclick="setFilter('active')" class="filter-btn px-4 py-2 rounded-lg font-medium text-sm">Active</button>
                                <button onclick="setFilter('completed')" class="filter-btn px-4 py-2 rounded-lg font-medium text-sm">Done</button>
                                <button onclick="setFilter('important')" class="filter-btn px-4 py-2 rounded-lg font-medium text-sm">Important</button>
                                <button onclick="setFilter('overdue')" class="filter-btn px-4 py-2 rounded-lg font-medium text-sm">Overdue</button>
                            </div>
                        </div>
                    </div>

                    <!-- Todo List -->
                    <div class="glass rounded-2xl overflow-hidden">
                        <div id="todoList" class="divide-y divide-white/10"></div>
                        <div id="emptyState" class="p-8 md:p-12 text-center hidden">
                            <div class="w-16 h-16 glass rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold text-white mb-2">Ready to be productive!</h3>
                            <p class="text-white/70">Add your first task to get started</p>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="space-y-6 md:space-y-8">
                    <!-- AI Insights -->
                    <div class="glass rounded-2xl p-4 md:p-6 hover-lift">
                        <div class="flex items-center gap-3 mb-6">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                            <h3 class="text-lg font-semibold text-white">AI Insights</h3>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between text-sm mb-2 text-white">
                                    <span>Completion Rate</span>
                                    <span id="completionRate" class="font-semibold">0%</span>
                                </div>
                                <div class="w-full bg-white/20 rounded-full h-3">
                                    <div id="completionBar" class="progress-bar h-3" style="width: 0%"></div>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 text-center">
                                <div class="glass rounded-lg p-3">
                                    <p id="importantPending" class="text-2xl font-bold text-white">0</p>
                                    <p class="text-xs text-white/70">Important</p>
                                </div>
                                <div class="glass rounded-lg p-3">
                                    <p id="overdueTasks" class="text-2xl font-bold text-white">0</p>
                                    <p class="text-xs text-white/70">Overdue</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Smart Schedule -->
                    <div class="glass rounded-2xl p-4 md:p-6 hover-lift">
                        <div class="flex items-center gap-3 mb-6">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            <h3 class="text-lg font-semibold text-white">Smart Schedule</h3>
                        </div>
                        <div id="smartSchedule" class="space-y-3"></div>
                    </div>

                    <!-- AI Recommendation -->
                    <div class="glass rounded-2xl p-4 md:p-6 hover-lift">
                        <div class="flex items-center gap-3 mb-4">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                            </svg>
                            <h3 class="text-lg font-semibold text-white">AI Coach</h3>
                        </div>
                        <p id="aiRecommendation" class="text-white/80 leading-relaxed text-sm md:text-base">
                            Add tasks to get personalized recommendations!
                        </p>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="text-center mt-8 md:mt-12 space-y-4">
                <div id="successMessage" class="text-white/90 text-base md:text-lg font-medium hidden"></div>
                <div class="flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-3 text-white/60 text-sm md:text-base">
                    <span class="font-medium">Created by Divyansh Raj Soni</span>
                    <span class="hidden sm:inline">•</span>
                    <span class="flex items-center gap-2">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/>
                        </svg>
                        Built with AI
                    </span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let todos = [];
        let currentFilter = 'all';
        let nextId = 1;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadSampleTodos();
            setupEventListeners();
            setTimeout(generateAISuggestions, 1000);
        });

        function setupEventListeners() {
            const newTodoInput = document.getElementById('newTodo');
            if (newTodoInput) {
                newTodoInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        addTodo();
                    }
                });
            }
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            if (notification && notificationText) {
                notificationText.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }

        function loadSampleTodos() {
            const sampleTodos = [
                {
                    id: nextId++,
                    text: "Review quarterly sales report",
                    completed: false,
                    important: true,
                    createdAt: new Date().toISOString(),
                    category: "work",
                    estimatedTime: 45,
                    priority: "high",
                    aiGenerated: false,
                    dueDate: null,
                    dueTime: null,
                    notes: null
                },
                {
                    id: nextId++,
                    text: "Schedule dentist appointment",
                    completed: false,
                    important: false,
                    createdAt: new Date(Date.now() - 86400000).toISOString(),
                    category: "health",
                    estimatedTime: 15,
                    priority: "medium",
                    aiGenerated: false,
                    dueDate: null,
                    dueTime: null,
                    notes: null
                }
            ];
            todos = sampleTodos;
            updateDisplay();
        }

        function addTodo() {
            const input = document.getElementById('newTodo');
            const text = input?.value?.trim();
            if (!text) return;

            // Get advanced options
            const dueDate = document.getElementById('dueDate')?.value || null;
            const dueTime = document.getElementById('dueTime')?.value || null;
            const manualCategory = document.getElementById('manualCategory')?.value || 'auto';
            const manualPriority = document.getElementById('manualPriority')?.value || 'auto';
            const taskNotes = document.getElementById('taskNotes')?.value?.trim() || null;
            const manualTime = document.getElementById('manualTime')?.value;
            const markImportant = document.getElementById('markImportant')?.checked || false;

            const todo = {
                id: nextId++,
                text: text,
                completed: false,
                important: markImportant,
                createdAt: new Date().toISOString(),
                category: manualCategory === 'auto' ? detectCategory(text) : manualCategory,
                estimatedTime: manualTime ? parseInt(manualTime) : estimateTime(text),
                priority: manualPriority === 'auto' ? detectPriority(text) : manualPriority,
                aiGenerated: false,
                dueDate: dueDate,
                dueTime: dueTime,
                notes: taskNotes
            };

            todos.unshift(todo);
            clearForm();
            updateDisplay();
            showNotification('Task added successfully!');
        }

        function clearForm() {
            const fields = [
                'newTodo', 'dueDate', 'dueTime', 'taskNotes', 'manualTime'
            ];
            
            fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) field.value = '';
            });

            const selectFields = ['manualCategory', 'manualPriority'];
            selectFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) field.value = 'auto';
            });

            const checkbox = document.getElementById('markImportant');
            if (checkbox) checkbox.checked = false;
        }

        function toggleAdvancedOptions() {
            const options = document.getElementById('advancedOptions');
            const toggle = document.getElementById('advancedToggle');
            
            if (options && toggle) {
                if (options.classList.contains('hidden')) {
                    options.classList.remove('hidden');
                    toggle.classList.add('bg-white/20');
                } else {
                    options.classList.add('hidden');
                    toggle.classList.remove('bg-white/20');
                }
            }
        }

        function editTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (!todo) return;

            // Pre-fill the form
            const fields = {
                'newTodo': todo.text,
                'dueDate': todo.dueDate || '',
                'dueTime': todo.dueTime || '',
                'manualCategory': todo.category,
                'manualPriority': todo.priority,
                'taskNotes': todo.notes || '',
                'manualTime': todo.estimatedTime.toString()
            };

            Object.entries(fields).forEach(([fieldId, value]) => {
                const field = document.getElementById(fieldId);
                if (field) field.value = value;
            });

            const importantCheckbox = document.getElementById('markImportant');
            if (importantCheckbox) importantCheckbox.checked = todo.important;

            // Show advanced options
            const options = document.getElementById('advancedOptions');
            const toggle = document.getElementById('advancedToggle');
            if (options && toggle) {
                options.classList.remove('hidden');
                toggle.classList.add('bg-white/20');
            }

            // Remove the task (will be re-added when user clicks Add)
            deleteTodo(id);
            
            // Focus on input
            const input = document.getElementById('newTodo');
            if (input) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                setTimeout(() => {
                    input.focus();
                    showNotification('Task loaded for editing');
                }, 500);
            }
        }

        function detectCategory(text) {
            const keywords = {
                work: ['meeting', 'report', 'project', 'email', 'presentation', 'deadline', 'client', 'business'],
                health: ['doctor', 'dentist', 'exercise', 'gym', 'medicine', 'appointment', 'workout', 'fitness'],
                personal: ['family', 'friend', 'birthday', 'vacation', 'hobby', 'book', 'movie', 'shopping'],
                learning: ['course', 'tutorial', 'study', 'learn', 'practice', 'skill', 'research', 'training'],
                finance: ['budget', 'bank', 'payment', 'invoice', 'tax', 'money', 'expense', 'investment'],
                productivity: ['organize', 'plan', 'schedule', 'optimize', 'improve', 'system', 'workflow']
            };

            const lowercaseText = text.toLowerCase();
            for (const [category, words] of Object.entries(keywords)) {
                if (words.some(word => lowercaseText.includes(word))) {
                    return category;
                }
            }
            return 'general';
        }

        function estimateTime(text) {
            const timeKeywords = {
                5: ['quick', 'brief', 'short'],
                15: ['call', 'email', 'message', 'check'],
                30: ['review', 'read', 'organize'],
                60: ['meeting', 'presentation', 'report'],
                120: ['project', 'research', 'analysis']
            };

            const lowercaseText = text.toLowerCase();
            for (const [time, words] of Object.entries(timeKeywords)) {
                if (words.some(word => lowercaseText.includes(word))) {
                    return parseInt(time);
                }
            }
            return 30;
        }

        function detectPriority(text) {
            const highPriority = ['urgent', 'asap', 'important', 'critical', 'deadline', 'emergency'];
            const lowPriority = ['maybe', 'someday', 'when possible', 'if time', 'eventually'];
            
            const lowercaseText = text.toLowerCase();
            if (highPriority.some(word => lowercaseText.includes(word))) return 'high';
            if (lowPriority.some(word => lowercaseText.includes(word))) return 'low';
            return 'medium';
        }

        function toggleTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (todo) {
                todo.completed = !todo.completed;
                updateDisplay();
                showNotification(todo.completed ? 'Task completed!' : 'Task reactivated');
            }
        }

        function deleteTodo(id) {
            todos = todos.filter(todo => todo.id !== id);
            updateDisplay();
            showNotification('Task deleted');
        }

        function toggleImportant(id) {
            const todo = todos.find(t => t.id === id);
            if (todo) {
                todo.important = !todo.important;
                updateDisplay();
                showNotification(todo.important ? 'Marked as important' : 'Removed importance');
            }
        }

        function setFilter(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            filterTodos();
        }

        function filterTodos() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput ? searchInput.value.toLowerCase() : '';
            
            const filteredTodos = todos.filter(todo => {
                const matchesSearch = todo.text.toLowerCase().includes(searchTerm);
                let matchesFilter = false;
                
                switch(currentFilter) {
                    case 'all':
                        matchesFilter = true;
                        break;
                    case 'active':
                        matchesFilter = !todo.completed;
                        break;
                    case 'completed':
                        matchesFilter = todo.completed;
                        break;
                    case 'important':
                        matchesFilter = todo.important;
                        break;
                    case 'overdue':
                        matchesFilter = isOverdue(todo);
                        break;
                    default:
                        matchesFilter = true;
                }
                
                return matchesSearch && matchesFilter;
            });

            renderTodos(filteredTodos);
        }

        function renderTodos(todoList = []) {
            const todoListElement = document.getElementById('todoList');
            const emptyState = document.getElementById('emptyState');

            if (!todoListElement || !emptyState) return;

            if (todoList.length === 0) {
                todoListElement.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            todoListElement.innerHTML = todoList.map(todo => `
                <div class="todo-item p-4 md:p-6 priority-${todo.priority} ${todo.completed ? 'completed' : ''}">
                    <div class="flex items-start gap-4">
                        <button
                            onclick="toggleTodo(${todo.id})"
                            class="w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all mt-1 flex-shrink-0 ${
                                todo.completed
                                    ? 'bg-green-500 border-green-500 text-white'
                                    : 'border-gray-300 hover:border-green-400'
                            }"
                        >
                            ${todo.completed ? '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>' : ''}
                        </button>

                        <div class="flex-1 min-w-0">
                            <div class="flex items-start gap-3 mb-2">
                                <p class="text-white font-semibold text-sm md:text-base break-words ${todo.completed ? 'line-through opacity-60' : ''}">
                                    ${todo.text}
                                </p>
                                ${todo.aiGenerated ? `
                                    <span class="ai-badge inline-flex items-center gap-1 px-2 py-1 text-white rounded-full text-xs flex-shrink-0">
                                        <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z"/>
                                        </svg>
                                        AI
                                    </span>
                                ` : ''}
                            </div>
                            <div class="flex flex-wrap items-center gap-2 text-xs md:text-sm text-white/80 mb-2">
                                <span class="category-badge category-${todo.category}">
                                    ${todo.category}
                                </span>
                                <span class="px-2 py-1 bg-white/10 rounded">${todo.estimatedTime} min</span>
                                <span class="font-semibold ${
                                    todo.priority === 'high' ? 'text-red-400' : 
                                    todo.priority === 'medium' ? 'text-yellow-400' : 'text-green-400'
                                }">
                                    ${todo.priority.toUpperCase()}
                                </span>
                                ${todo.dueDate ? `
                                    <span class="flex items-center gap-1 ${isOverdue(todo) ? 'text-red-400 font-semibold' : isDueToday(todo) ? 'text-yellow-400 font-semibold' : 'text-blue-400'}">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                        </svg>
                                        ${formatDueDate(todo)}
                                    </span>
                                ` : ''}
                            </div>
                            ${todo.notes ? `
                                <div class="text-white/60 text-xs md:text-sm italic mt-2 break-words">
                                    "${todo.notes}"
                                </div>
                            ` : ''}
                        </div>

                        <div class="flex items-center gap-1 md:gap-2 flex-shrink-0">
                            ${todo.dueDate && (isOverdue(todo) || isDueToday(todo)) ? `
                                <span class="px-2 py-1 rounded-full text-xs font-bold ${isOverdue(todo) ? 'overdue-badge' : 'due-today-badge'}">
                                    ${isOverdue(todo) ? 'OVERDUE' : 'DUE TODAY'}
                                </span>
                            ` : ''}
                            <button
                                onclick="editTodo(${todo.id})"
                                class="p-2 text-white/50 hover:text-blue-400 hover:bg-blue-400/20 rounded-lg transition-colors"
                                title="Edit task"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button
                                onclick="toggleImportant(${todo.id})"
                                class="p-2 rounded-lg transition-colors ${
                                    todo.important
                                        ? 'text-yellow-400 bg-yellow-400/20'
                                        : 'text-white/50 hover:text-yellow-400 hover:bg-yellow-400/20'
                                }"
                                title="${todo.important ? 'Remove importance' : 'Mark as important'}"
                            >
                                <svg class="w-4 h-4" fill="${todo.important ? 'currentColor' : 'none'}" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                                </svg>
                            </button>
                            <button
                                onclick="deleteTodo(${todo.id})"
                                class="p-2 text-white/50 hover:text-red-400 hover:bg-red-400/20 rounded-lg transition-colors"
                                title="Delete task"
                            >
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function isOverdue(todo) {
            if (!todo.dueDate || todo.completed) return false;
            const dueDateTime = new Date(todo.dueDate + (todo.dueTime ? 'T' + todo.dueTime : 'T23:59'));
            return dueDateTime < new Date();
        }

        function isDueToday(todo) {
            if (!todo.dueDate || todo.completed) return false;
            const dueDate = new Date(todo.dueDate);
            const today = new Date();
            return dueDate.toDateString() === today.toDateString();
        }

        function formatDueDate(todo) {
            if (!todo.dueDate) return '';
            
            const dueDate = new Date(todo.dueDate);
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            let dateStr = '';
            if (dueDate.toDateString() === today.toDateString()) {
                dateStr = 'Today';
            } else if (dueDate.toDateString() === tomorrow.toDateString()) {
                dateStr = 'Tomorrow';
            } else {
                dateStr = dueDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            }
            
            if (todo.dueTime) {
                const timeStr = new Date(`2000-01-01T${todo.dueTime}`).toLocaleTimeString('en-US', { 
                    hour: 'numeric', 
                    minute: '2-digit', 
                    hour12: true 
                });
                return `${dateStr} at ${timeStr}`;
            }
            
            return dateStr;
        }

        function updateStats() {
            const total = todos.length;
            const completed = todos.filter(t => t.completed).length;
            const active = todos.filter(t => !t.completed).length;
            const important = todos.filter(t => t.important && !t.completed).length;
            const overdue = todos.filter(t => isOverdue(t)).length;
            const dueToday = todos.filter(t => isDueToday(t)).length;

            const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
            const productivity = completionRate > 80 ? "Excellent" : completionRate > 60 ? "Good" : completionRate > 40 ? "Fair" : "Needs Work";

            // Update UI elements safely
            const elements = {
                'totalCount': total,
                'activeCount': active,
                'completedCount': completed,
                'productivityLevel': productivity,
                'completionRate': completionRate + '%',
                'importantPending': important,
                'overdueTasks': overdue
            };

            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });

            const completionBar = document.getElementById('completionBar');
            if (completionBar) {
                completionBar.style.width = completionRate + '%';
            }

            const successMessage = document.getElementById('successMessage');
            if (successMessage) {
                if (completed > 0) {
                    let message = `Great job! You've completed ${completed} task${completed !== 1 ? 's' : ''}.`;
                    if (dueToday > 0) message += ` You have ${dueToday} task${dueToday !== 1 ? 's' : ''} due today.`;
                    if (overdue > 0) message += ` ${overdue} task${overdue !== 1 ? 's are' : ' is'} overdue.`;
                    successMessage.textContent = message;
                    successMessage.classList.remove('hidden');
                } else {
                    successMessage.classList.add('hidden');
                }
            }

            updateAIRecommendation(completionRate, important, overdue, dueToday);
            updateSmartSchedule();
        }

        function updateAIRecommendation(completion, important, overdue, dueToday) {
            let recommendation;
            if (overdue > 0) {
                recommendation = `🚨 You have ${overdue} overdue task${overdue !== 1 ? 's' : ''}! Focus on completing them first.`;
            } else if (dueToday > 0) {
                recommendation = `⏰ ${dueToday} task${dueToday !== 1 ? 's are' : ' is'} due today. Prioritize these to stay on track.`;
            } else if (important > 3) {
                recommendation = "⭐ You have many important tasks. Consider time-blocking your calendar for better focus.";
            } else if (completion < 30) {
                recommendation = "🎯 Break large tasks into smaller, manageable steps for better progress.";
            } else if (completion > 80) {
                recommendation = "🏆 Excellent progress! You're crushing your goals. Keep up the momentum!";
            } else {
                recommendation = "💪 Keep up the steady progress. Try the 2-minute rule for quick wins.";
            }

            const element = document.getElementById('aiRecommendation');
            if (element) element.textContent = recommendation;
        }

        function updateSmartSchedule() {
            const activeTodos = todos.filter(t => !t.completed);
            const schedule = activeTodos
                .sort((a, b) => {
                    // Prioritize overdue and due today tasks
                    const aUrgency = isOverdue(a) ? 4 : isDueToday(a) ? 3 : 0;
                    const bUrgency = isOverdue(b) ? 4 : isDueToday(b) ? 3 : 0;
                    
                    if (aUrgency !== bUrgency) return bUrgency - aUrgency;
                    
                    // Then by priority and importance
                    const priorityWeight = { high: 3, medium: 2, low: 1 };
                    const aScore = (priorityWeight[a.priority] || 2) + (a.important ? 2 : 0);
                    const bScore = (priorityWeight[b.priority] || 2) + (b.important ? 2 : 0);
                    return bScore - aScore;
                })
                .slice(0, 4)
                .map((todo, index) => ({
                    ...todo,
                    suggestedTime: `${9 + index * 2}:00 AM`,
                    reason: isOverdue(todo) ? "🚨 OVERDUE - Handle immediately" :
                            isDueToday(todo) ? "⏰ Due today - High priority" :
                            index === 0 ? "🔥 Start with highest priority" : 
                            index === 1 ? "⚡ Build momentum" : 
                            index === 2 ? "🧠 Mid-morning focus" : 
                            "📋 Before lunch completion"
                }));

            const scheduleElement = document.getElementById('smartSchedule');
            if (!scheduleElement) return;

            if (schedule.length === 0) {
                scheduleElement.innerHTML = '<p class="text-white/70 text-center py-4 text-sm">🎉 All tasks completed! Add new tasks to see your schedule.</p>';
                return;
            }

            scheduleElement.innerHTML = schedule.map(task => `
                <div class="glass rounded-lg p-3 hover:bg-white/20 transition-all ${isOverdue(task) ? 'border-l-4 border-red-400' : isDueToday(task) ? 'border-l-4 border-yellow-400' : ''}">
                    <div class="flex items-center gap-3">
                        <div class="text-xs md:text-sm font-semibold text-white bg-white/20 rounded px-2 py-1 min-w-[60px] text-center flex-shrink-0">
                            ${task.suggestedTime}
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-white text-xs md:text-sm font-medium truncate">${task.text}</p>
                            <p class="text-white/70 text-xs">${task.reason}</p>
                            ${task.dueDate ? `<p class="text-blue-300 text-xs mt-1">Due: ${formatDueDate(task)}</p>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function generateAISuggestions() {
            const suggestions = [
                "Take a 10-minute walk to boost creativity",
                "Review your goals for this week",
                "Organize your workspace for better focus",
                "Plan tomorrow's top 3 priorities",
                "Send a thank you message to someone",
                "Read one article in your field",
                "Practice a new skill for 15 minutes",
                "Clear your email inbox",
                "Back up important files",
                "Call a friend or family member",
                "Plan a healthy meal",
                "Do some deep breathing exercises",
                "Write down 3 things you're grateful for",
                "Declutter your digital files"
            ];

            const contextualSuggestions = suggestions
                .sort(() => Math.random() - 0.5)
                .slice(0, 2)
                .map((text, index) => ({
                    id: 'suggestion-' + Date.now() + index,
                    text,
                    category: ["productivity", "health", "learning", "work", "personal"][Math.floor(Math.random() * 5)],
                    estimatedTime: [10, 15, 20, 30][Math.floor(Math.random() * 4)],
                    priority: ["low", "medium", "high"][Math.floor(Math.random() * 3)],
                    aiGenerated: true
                }));

            const suggestionsContainer = document.getElementById('aiSuggestions');
            const suggestionsList = document.getElementById('suggestionsList');

            if (contextualSuggestions.length > 0 && suggestionsContainer && suggestionsList) {
                suggestionsContainer.classList.remove('hidden');
                suggestionsList.innerHTML = contextualSuggestions.map(suggestion => `
                    <div class="suggestion-card rounded-lg p-4">
                        <p class="text-white font-medium mb-3 text-sm">${suggestion.text}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-white/70 text-xs">${suggestion.estimatedTime} min</span>
                            <button
                                onclick="addSuggestedTask('${suggestion.id}', \`${suggestion.text.replace(/`/g, '\\`')}\`, '${suggestion.category}', ${suggestion.estimatedTime}, '${suggestion.priority}')"
                                class="px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-xs font-medium text-white transition-all"
                            >
                                Add
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        function addSuggestedTask(id, text, category, estimatedTime, priority) {
            const cleanText = text.replace(/'/g, "").replace(/"/g, "");
            
            const todo = {
                id: nextId++,
                text: cleanText,
                completed: false,
                important: false,
                createdAt: new Date().toISOString(),
                category: category,
                estimatedTime: estimatedTime,
                priority: priority,
                aiGenerated: true,
                dueDate: null,
                dueTime: null,
                notes: null
            };

            todos.unshift(todo);
            updateDisplay();
            showNotification('AI suggestion added!');
            
            // Remove the suggestion
            const suggestionElement = event.target.closest('.suggestion-card');
            if (suggestionElement) {
                suggestionElement.style.opacity = '0';
                suggestionElement.style.transform = 'scale(0.8)';
                setTimeout(() => suggestionElement.remove(), 300);
            }
            
            // Generate new suggestions if needed
            setTimeout(() => {
                const remainingSuggestions = document.querySelectorAll('#suggestionsList .suggestion-card').length;
                if (remainingSuggestions < 1) {
                    generateAISuggestions();
                }
            }, 500);
        }

        function updateDisplay() {
            filterTodos();
            updateStats();
        }

        // Auto-generate new suggestions every 60 seconds
        setInterval(generateAISuggestions, 60000);
    </script>
</body>
</html>